import{l as R,m as T}from"./index.DFPIkN7S.js";import{r as _}from"./scheduler.BOveaGQ6.js";import{w as x}from"./index.DhKR1buT.js";function j(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function k(e,i){R(e,1,1,()=>{i.delete(e.key)})}function q(e,i,f,a,m,r,l,E,v,J,p,N){let o=e.length,c=r.length,d=o;const g={};for(;d--;)g[e[d].key]=d;const u=[],y=new Map,I=new Map,A=[];for(d=c;d--;){const t=N(m,r,d),s=f(t);let n=l.get(s);n?A.push(()=>n.p(t,i)):(n=J(s,t),n.c()),y.set(s,u[d]=n),s in g&&I.set(s,Math.abs(d-g[s]))}const C=new Set,M=new Set;function S(t){T(t,1),t.m(E,p),l.set(t.key,t),p=t.first,c--}for(;o&&c;){const t=u[c-1],s=e[o-1],n=t.key,w=s.key;t===s?(p=t.first,o--,c--):y.has(w)?!l.has(n)||C.has(n)?S(t):M.has(w)?o--:I.get(n)>I.get(w)?(M.add(n),S(t)):(C.add(w),o--):(v(s,l),o--)}for(;o--;){const t=e[o];y.has(t.key)||v(t,l)}for(;c;)S(u[c-1]);return _(A),u}const b="cart_items";function F(){if(typeof window<"u"&&window.localStorage){const e=window.localStorage.getItem(b);return e?JSON.parse(e):[]}return[]}function P(e){typeof window<"u"&&window.localStorage&&window.localStorage.setItem(b,JSON.stringify(e))}const h=class h{constructor(){this.Id=h._id++,this.Positions=x(F()),this.Positions.subscribe(i=>P(i))}AddProductToCart(i){this.Positions.update(f=>{const a=[...f,i];return P(a),a})}RemoveProductFromCart(i){this.Positions.update(f=>{const a=f.filter((m,r)=>m.Id===i);return P(a),a})}};h._id=0;let O=h;export{O as C,j as e,k as o,q as u};
